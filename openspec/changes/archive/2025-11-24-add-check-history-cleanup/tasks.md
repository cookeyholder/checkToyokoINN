# Implementation Tasks

## 1. 實作清理邏輯
- [x] 1.1 在 `checkAllReminders()` 函式末尾 (所有提醒檢查完成後) 新增清理邏輯區塊
- [x] 1.2 實作取得「檢查歷史」工作表總列數的邏輯 (`sheet.getLastRow()`)
- [x] 1.3 判斷總列數是否超過 100,000 列
- [x] 1.4 如超過閾值,使用 `sheet.deleteRows(2, 96999)` 刪除第 2 列到第 97,000 列
- [x] 1.5 在 Logger 中記錄清理操作的詳細資訊 (刪除列數、保留列數)

## 2. 錯誤處理
- [x] 2.1 使用 try-catch 包裹清理邏輯,確保錯誤不影響主流程
- [x] 2.2 在 catch 區塊中記錄錯誤訊息到 Logger
- [x] 2.3 確保清理失敗不會中斷 `checkAllReminders()` 的正常執行

## 3. 測試
- [x] 3.1 測試正常情況: 總列數小於 100,000 列時不執行清理
- [x] 3.2 測試清理情況: 手動建立超過 100,000 列的測試資料,驗證清理邏輯正確執行
- [x] 3.3 驗證清理後保留的記錄數量正確 (標題列 + 最近約 3,000 筆)
- [x] 3.4 確認 Logger 訊息正確記錄清理操作

## 4. 文檔更新
- [x] 4.1 更新相關註解,說明檢查歷史的自動清理機制
- [x] 4.2 如有使用者文檔,補充說明歷史記錄保留策略
